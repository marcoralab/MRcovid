library(tidyr)
library(dplyr)
## Sample Sizes
samplesize = tribble(~code, ~domain, ~trait, ~pmid, ~logistic, ~samplesize, ~ncase, ~ncontrol, ~prevelance,
                  "Lambert2013load", "Disease liability", "LOAD", 0820047, TRUE, 63926, 21982, 41944, 0.31,
                  "Kunkle2019load", "Disease liability", "Alzheimer's disease", 24162737, TRUE, 54162, 17008, 37154, 0.31,
                  "Huang2017aaos", "Disease liability", "AAOS", 28628103, TRUE, 40255, 14406, 25849, 0.31,
                  "Deming2017ab42", "CSF", "AB42", 28247064, FALSE, 3146, NA, NA, NA,
                  "Deming2017ptau", "CSF", "Ptau181", 28247064, FALSE, 3146, NA, NA, NA,
                  "Deming2017tau", "CSF", "Tau", 28247064, FALSE, 3146, NA, NA, NA,
                  "Hilbar2017hipv", "Neuroimaging", "Hippocampal Volume", 28098162, FALSE, 26814, NA, NA, NA,
                  "Hilbar2015hipv", "Neuroimaging", "Hippocampal Volume", 25607358, FALSE, 13688, NA, NA, NA,
                  "Grasby2020surfarea", "Neuroimaging", "Cortical Surface Area", 32193296, FALSE, 33709, NA, NA, NA,
                  "Grasby2020thickness","Neuroimaging", "Cortical Thickness", 32193296, FALSE, 33709, NA, NA, NA,
                  "Beecham2014npany", "Neuropathology", "Neuritic Plaques", 25188341, TRUE, 4046, 3426, 620, 0.36,
                  "Beecham2014braak4", "Neuropathology", "Neurofibrillary Tangles", 25188341, TRUE, 4735, 2927, 1808, 0.93,
                  "Beecham2014vbiany", "Neuropathology", "Vascular Brain Injury", 25188341, TRUE, 2764, 992, 1772, 0.2,
                  "Yengo2018bmi", "Risk factor", "BMI", 30124842, FALSE, 690495, NA, NA, NA,
                  "Locke2015bmi", "Risk factor", "BMI, Locke", 25673413, FALSE, 339224, NA, NA, NA,
                  "Xue2018diab", "Disease liability", "Type 2 diabetes", 30054458, TRUE, 659316, 62892, 596424, 0.085,
                  "Niarchou2020meat", "Behavioural", "Meat diet", 32066663, FALSE, 335576, NA, NA, NA,
                  "Niarchou2020fish", "Behavioural", "Fish and Plant diet", 32066663, FALSE, 335576, NA, NA, NA,
                  "Wells2019hdiff", "Health", "Hearing difficulties", 31564434, FALSE, 250389, 87056, 163333, 0.35,
                  "Willer2013hdl", "Biomarker", "High-density lipoproteins", 24097068, FALSE, 188577, NA, NA, NA,
                  "Willer2013ldl", "Biomarker", "Low-density lipoproteins", 24097068, FALSE, 188577, NA, NA, NA,
                  "Willer2013tc", "Biomarker", "Total cholesterol", 24097068, FALSE, 188577, NA, NA, NA,
                  "Willer2013tg", "Biomarker", "Triglycerides", 24097068, FALSE, 188577, NA, NA, NA,
                  "Dashti2019slepdur",  "Risk factor", "Sleep duration", 30846698, FALSE, 446118, NA, NA, NA,
                  "Campos2020snor",  "Risk factor", "Snoring", 32060260, FALSE, 408317, NA, NA, NA,
                  "Day2018sociso", "Behavioural", "Social isolation", 29970889, FALSE, 452302, NA, NA, NA,
                  "Klimentidis2018mvpa", "Behavioural", "Moderate-to-vigorous PA", 29899525, FALSE, 377234, NA, NA, NA,
                  "Evangelou2018dbp", "Risk factor", "Diastolic blood pressure", 30224653, FALSE, 757601, NA, NA, NA,
                  "Evangelou2018sbp", "Risk factor", "Systolic blood pressure", 30224653, FALSE, 757601, NA, NA, NA,
                  "Evangelou2018pp", "Risk factor", "Pulse pressure", 30224653, FALSE, 757601, NA, NA, NA,
                  "Liu2019drnkwk23andMe", "Behavioural", "Alcohol consumption", 30643251, FALSE, 941280, NA, NA, NA,
                  "Liu2019drnkwk", "Behavioural", "Alcohol consumption", 30643251, FALSE, 537349,  NA, NA, NA,
                  "Liu2019smkcpd23andMe", "Risk factor", "Cigarettes per day", 30643251, FALSE, 337334, NA, NA, NA,
                  "Liu2019smkcpd", "Risk factor", "Cigarettes per day", 30643251, FALSE, 263954, NA, NA, NA,
                  "Liu2019smkint23andMe", "Risk factor", "Smoking initiation", 30643251, TRUE, 1232091, 557337, 674754, 0.45,
                  "Liu2019smkint", "Risk factor", "Smoking initiation", 30643251, TRUE, 632802, 311628, 321174, 0.45,
                  "Liu2019smkaoi", "Risk factor", "Smoking AOI", 30643251, FALSE, 262990, NA, NA, NA,
                  "Liu2019smkces", "Risk factor", "Smoking cessation", 30643251, TRUE, 312821, 139453, 407766, 0.44,
                  "Jansen2018insomnia23andMe", "Risk factor", "Insomnia symptoms", 30804565, TRUE, 1331010, 397972, 933038, 0.29,
                  "Jansen2018insom", "Risk factor", "Insomnia symptoms", 30804565, TRUE, 386533, 108229, 278304, 0.28,
                  "Howard2019dep23andMe", "Risk factor", "Depression", 30718901, TRUE, 807553, 246363, 561190, 0.32,
                  "Howard2018dep", "Risk factor", "Depression", 30718901, TRUE, 322580, 113769, 208811, 0.35,
                  "SanchezRoige2019auditt23andMe", "Behavioural", "AUDIT", 30336701, FALSE, 141932, NA, NA, NA,
                  "Lee2018education23andMe", "Behavioural", "Educational attainment", 30038396, FALSE, 1131881, NA, NA, NA,
                  "Lee2018educ", "Behavioural", "Educational attainment", 30038396, FALSE, 775120, NA, NA, NA,
                  "Okbay2016educ", "Behavioural", "Education, Okbay", 27225129, FALSE, 293723, NA, NA, NA,
                  "Chauhan2019bi", "Neuropathology", "Brain infarcts", 30651383, TRUE, 21682, 3726, 17956, 0.2,
                  "Revez2020vit250hd", "Biomarker", "25 hydroxyvitamin D", 32242144, FALSE, 417580, NA, NA, NA,
                  "Okada2014rartis", "Disease liability", "Rheumatoid arthritis", 24390342, TRUE, 58284, 14361, 43923, 0.005,
                  "Nalls2019pd", "Disease liability", "Parkinsons disease", 31701892, TRUE, 482730, 56306, 1417791, 0.005,
                  "Huang2017aaos", "Disease liability", "AAOS", 28628103, TRUE, 40255, 14406, 25849, 0.31,
                  "Ligthart2018crp", "Biomarker", "CRP", 30388399, FALSE, 204402, NA, NA, NA,
                  "Yengo2018height", "Risk factor", "Height", 30124842, FALSE, 693529, NA, NA, NA,
                  "Wood2014height", "Risk factor", "Height", 25282103, FALSE, 253288, NA, NA, NA,
                  "Betham2015lupus", "Disease liability", "Lupus", 26502338, TRUE, 23210, 7219, 15991, 0.0024,
                  "Beecham2013multscler", "Disease liability", "Multiple sclerosis", 24076602, TRUE, 38589, 14498, 24091, 0.0045,
                  "Patsopoulos2019multscler", "Disease liability", "Multiple sclerosis", 31604244, TRUE, 115803, 47429, 68374, 0.0045,
                  "Malik2018as", "Disease liability", "Any stroke", 29531354, TRUE, 446696, 40585, 406111, 0.055,
                  "Malik2018ais", "Disease liability", "Ischemic stroke", 29531354, TRUE, 440328, 34217, 406111, 0.055,
                  "Wuttke2019egfr", "Biomarker", "eGFR", 31152163, FALSE, 765286, NA, NA, NA,
                  "Wuttke2019ckd", "Disease liability", "Chronic kidney disease", 31152163, TRUE, 659525, 53339, 606186, 0.08,
                  "Nikpay2015cad", "Disease liability", "Coronary artery disease", 26343387, TRUE, 184305, 60801, 123504, 0.05,
                  "Shah2020heartfailure", "Disease liability", "Heart failure", 31919418, TRUE, 977323, 47309, 930014, 0.025,
                  "Olafsdottir2020asthma", "Disease liability", "Asthma", 31959851, TRUE, 771388, 69189, 702199, 0.09,
                  "Allen2020ipf", "Disease liability", "Idiopathic pulmonary fibrosis", 31710517, TRUE, 11259, 2668, 8591, 0.0002,
                  "Nicolas2018als", "Disease liability", "Amyotrophic lateral sclerosis", 29566793, TRUE, 80610, 20806, 59804, 0.005,
                  "Linner2019risk", "Risk factor", "Risk tolerance", 30643258, FALSE, 466571, NA, NA, NA,
                  "Demontis2018adhd", "Disease liability", "ADHD", 30478444, TRUE, 53293, 19099, 34194, 0.05,
                  "Ripke2014scz", "Disease liability", "Schizophrenia", 25056061, TRUE, 77096, 33640, 43456, 0.01,
                  "Ripke2014sczall", "Disease liability", "Schizophrenia", 25056061, TRUE, 150064, 36989, 113075, 0.01,
                  "Stahl2019bip", "Disease liability", "Bipolar disorder", 31043756, TRUE, 51710, 20352, 31358, 0.01,
                  "Grove2019asd", "Disease liability", "Autism spectrum disorder", 30804558, TRUE, 46351, 18382, 27969, 0.02,
                  "Astel2016rbc", "Biomarker", "Red blood cell count", 27863252, FALSE, 173480, NA, NA, NA,
                  "Astel2016wbc", "Biomarker", "White blood cell count", 27863252, FALSE, 173480, NA, NA, NA,
                  "Astel2016plt", "Biomarker", "Platelet count", 27863252, FALSE, 173480, NA, NA, NA,
                  "Barban2016afb", "Behavioural", "Age at first birth", 27798627, FALSE, 251151, NA, NA, NA,
                  "Mills2021afb", "Behavioural", "Age at first birth", 9999, FALSE, 542901, NA, NA, NA,
                  "Mahajan2018t2d", "Diagnosis", "Diabetes", 30297969, TRUE, 898130, 74124, 824006, 0.085,
                  # Datafreez v4
                  "covidhgi2020anaA2v4", "Diagnosis", "COVID: A2", 9999, TRUE, 628238, 4336, 623902, 0.007,
                  "covidhgi2020anaA2v4eurwoukbb", "Diagnosis", "COVID: A2", 9999, TRUE, 22770, 3503, 19267, 0.15,
                  "covidhgi2020anaB1v4", "Diagnosis", "COVID: B1", 9999, TRUE, 10908, 2430, 8478,  0.22,
                  "covidhgi2020anaB2v4", "Diagnosis", "COVID: B2", 9999, TRUE, 969689, 7885, 961804,  0.008,
                  "covidhgi2020anaB2v4eur23andMe", "Diagnosis", "COVID: B2, EUR", 9999, TRUE, 1589523, 7019, 1582504, 0.004,
                  "covidhgi2020anaB2v4eur", "Diagnosis", "COVID: B2, EUR w/o 23andMe", 9999, TRUE, 908494, 6406, 902088,  0.007,
                  "covidhgi2020anaB2v4eurwoukbb", "Diagnosis", "COVID: B2, EUR w/o 23andMe, UKB", 9999, TRUE, 543388, 5641, 537747,  0.01,
                  "covidhgi2020anaC1v4", "Diagnosis", "COVID: C1", 9999, TRUE, 127879, 11085, 116794,  0.086,
                  "covidhgi2020anaC2v4", "Diagnosis", "COVID: C2", 9999, TRUE, 1388512, 17965, 1370547,  0.013,
                  "covidhgi2020anaC2v4eur23andMe", "Diagnosis", "COVID: C2, EUR", 9999, TRUE, 1393995, 24047,  1369948,  0.017,
                  "covidhgi2020anaC2v4eur", "Diagnosis", "COVID: C2, EUR w/o 23andMe", 9999, TRUE, 1299010, 14134, 1284876, 0.01,
                  "covidhgi2020anaC2v4eurwoukbb", "Diagnosis", "COVID: C2, EUR w/o 23andMe, UKB", 9999, TRUE, 927103, 12829, 914274,  0.01,
                  "covidhgi2020anaD1v4", "Diagnosis", "COVID: D1", 9999, TRUE, 38932, 3204, 35728,  0.082,
                  ## Datafreeze v5
                  "covidhgi2020A2v5alleur", "Diagnosis", "COVID: A2, EUR", 9999, TRUE, 1388208, 5042, 1383166, 0.00363,
                  "covidhgi2020B2v5alleur", "Diagnosis", "COVID: B2, EUR", 9999, TRUE, 1886753, 9668, 1877085, 0.00512,
                  "covidhgi2020C2v5alleur", "Diagnosis", "COVID: C2, EUR", 9999, TRUE, 1683587, 38878, 1644709, 0.0231,
                  "covidhgi2020A2v5alleurLeaveUKBB", "Diagnosis", "COVID: A2, EUR w/o UKB", 9999, TRUE, 1059322, 4733, 1054589, 0.00447,
                  "covidhgi2020B2v5alleurLeaveUKBB", "Diagnosis", "COVID: B2, EUR w/o UKB", 9999, TRUE, 1556506, 7998, 1548508, 0.00514,
                  "covidhgi2020C2v5alleurLeaveUKBB", "Diagnosis", "COVID: C2, EUR w/o UKB", 9999, TRUE, 1348520, 32388, 1316132, 0.0240,

                  ## Datafreeze v6
                  "covidhgi2020A2v6alleur", "Diagnosis", "COVID: A2, EUR", 9999, TRUE, 1639838, 7641, 1632197, 0.00466,
                  "covidhgi2020B2v6alleur", "Diagnosis", "COVID: B2, EUR", 9999, TRUE, 2509514, 18605, 2490909, 0.00741,
                  "covidhgi2020C2v6alleur", "Diagnosis", "COVID: C2, EUR", 9999, TRUE, 2393659, 97783, 2295876, 0.04085,
                  "covidhgi2020A2v6all", "Diagnosis", "COVID: A2, ALL", 9999, TRUE, 2393659, 9376, 1776645, 0.005249,
                  "covidhgi2020B2v6all", "Diagnosis", "COVID: B2, ALL", 9999, TRUE, 2861299, 25027, 2836272, 0.00874,
                  "covidhgi2020C2v6all", "Diagnosis", "COVID: C2, ALL", 9999, TRUE, 2700931, 125584, 2575347, 0.04649)
                    ## ieugwas
#ieugwas <- read_csv(here::here("data", "raw", "ieugwas_201020.csv"))

# samplesize <- bind_rows(samplesize,
#           ieugwas %>%
#             select(code = id, domain = category, trait, pmid, samplesize = sample_size, ncase, ncontrol) %>%
#             mutate(logistic = ifelse(domain == "Binary", TRUE, FALSE),
#                    prevelance = ncase/samplesize)
#           )
